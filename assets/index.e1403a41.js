var U=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var s=(o,e,t)=>(U(o,e,"read from private field"),t?t.call(o):e.get(o)),n=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)},r=(o,e,t,d)=>(U(o,e,"write to private field"),d?d.call(o,t):e.set(o,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))d(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const S of a.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&d(S)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function d(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const x="R_P_S_L_S",z=[{type:"rps",score:0},{type:"rpsls",score:0}];function P(o){const e=o.getItem(x);return e?JSON.parse(e):(o.setItem(x,JSON.stringify(z)),z)}function J(o,e){const d=P(o).map(({type:i,score:a})=>i!==e.type?{type:i,score:a}:e);o.setItem(x,JSON.stringify(d))}const N={get:P,set:J};var G,v,T;class Y{constructor(e){n(this,G,"rps");n(this,v,0);n(this,T,window.sessionStorage);this.database=e,this.score=N.get(this.database).find(t=>t.type===this.type).score}set type(e){r(this,G,e)}set score(e){r(this,v,Math.round(e))}set database(e){r(this,T,e)}get type(){return s(this,G)}get score(){return s(this,v)}get database(){return s(this,T)}play(e){let t=["rock","paper","scissors"];this.type==="rpsls"&&(t=[...t,"lizard","spock"]);const d=Math.round(Math.random()*t.length)%t.length,i=t.at(d),a=this.calculateGameResult(e,i);let S=this.score;if(a==="you win"?this.score++:a==="you lose"&&this.score--,S!==this.score){const $={score:this.score,type:this.type};N.set(this.database,$)}return{user:e,house:i,result:a,score:this.score,type:this.type}}calculateGameResult(e,t){return e===t?"draw":e==="rock"&&(t==="lizard"||t==="scissors")||e==="paper"&&(t==="rock"||t==="spock")||e==="scissors"&&(t==="paper"||t==="lizard")||e==="lizard"&&(t==="spock"||t==="paper")||e==="spock"&&(t==="rock"||t==="scissors")?"you win":"you lose"}toggleGameType(){this.type=this.type==="rps"?"rpsls":"rps",this.score=N.get(this.database).find(e=>e.type===this.type).score}}G=new WeakMap,v=new WeakMap,T=new WeakMap;const q={rps:"./images/logo.svg",rpsls:"./images/logo-bonus.svg"},K={rps:"/images/image-rules.svg",rpsls:"/images/image-rules-bonus.svg"},y={original:"original",bonus:"bonus"},F="hand",g={on:"show",off:"hide"},V=["rock","paper","scissors","lizard","spock","winner","loser"];var R,I,_,A,C,p,w,M,k,B,L,f,u,h,l,E,b;class j{constructor(){n(this,R,void 0);n(this,I,void 0);n(this,_,void 0);n(this,A,void 0);n(this,C,void 0);n(this,p,void 0);n(this,w,void 0);n(this,M,void 0);n(this,k,void 0);n(this,B,void 0);n(this,L,void 0);n(this,f,void 0);n(this,u,void 0);n(this,h,void 0);n(this,l,void 0);n(this,E,void 0);n(this,b,void 0);r(this,R,document.getElementById("score")),r(this,I,document.getElementById("logoImg")),r(this,_,document.getElementById("gameTypeToggler")),r(this,A,document.getElementById("logoText")),r(this,C,document.getElementById("showRuleBtn")),r(this,p,document.getElementById("gameRuleModal")),r(this,w,document.getElementById("gameRuleImg")),r(this,k,document.getElementById("gameBoard")),r(this,M,document.querySelectorAll(".game-control")),r(this,B,document.getElementById("gameContainer")),r(this,L,document.getElementById("gameResultContainer")),r(this,f,document.getElementById("gameResult")),r(this,u,document.getElementById("newGame")),r(this,h,document.getElementById("user")),r(this,l,document.getElementById("house")),r(this,E,document.getElementById("user__img")),r(this,b,document.getElementById("house__img"))}toggleRulesModal(e){if(s(this,p).open){s(this,p).close();return}this.updateRuleImage(e),s(this,p).showModal()}paintHeader(e,t){s(this,R).textContent=t.toString(),s(this,I).setAttribute("src",q[e]),s(this,I).setAttribute("alt",e),s(this,A).textContent=e}toggleGameMode(e){const{classList:t}=s(this,k);if(e==="rps"){t.remove(y.bonus),t.contains(y.original)||t.add(y.original);return}t.remove(y.original),t.contains(y.bonus)||t.add(y.bonus)}getHandInfo(e){return e.dataset[F]}async showResultUI(e){this.hideGameBoard(),this.showGameResult(),s(this,u).classList.contains("hide")||s(this,u).classList.add("hide"),s(this,f).textContent="",O(s(this,h)),O(s(this,l)),s(this,h).classList.add(e.user),s(this,E).setAttribute("src",`images/icon-${e.user}.svg`),s(this,E).setAttribute("alt",e.user),await Q(()=>{s(this,b).setAttribute("src",`images/icon-${e.house}.svg`),s(this,b).setAttribute("alt",e.house),s(this,l).classList.remove("placeholder"),s(this,l).classList.add(e.house),s(this,f).textContent=e.result,e.result==="you win"?(s(this,h).classList.add("winner"),s(this,l).classList.add("loser")):e.result==="you lose"&&(s(this,h).classList.add("loser"),s(this,l).classList.add("winner")),s(this,u).classList.remove("hide"),this.paintHeader(e.type,e.score)},2e3)}showGameBoardUI(){this.hideGameResult(),this.showGameBoard(),s(this,l).classList.contains("placeholder")||s(this,l).classList.add("placeholder"),s(this,f).textContent="",s(this,u).classList.add("hide"),O(s(this,h)),O(s(this,l))}updateRuleImage(e){s(this,w).setAttribute("src",K[e]),s(this,w).setAttribute("alt",e)}showGameBoard(){H(s(this,B),g.on,g.off)}hideGameBoard(){H(s(this,B),g.off,g.on)}showGameResult(){H(s(this,L),g.on,g.off)}hideGameResult(){H(s(this,L),g.off,g.on)}get gameToggleBtn(){return s(this,_)}get ruleModalToggleBtn(){return s(this,C)}get gameHandSelectors(){return s(this,M)}get newGameBtn(){return s(this,u)}}R=new WeakMap,I=new WeakMap,_=new WeakMap,A=new WeakMap,C=new WeakMap,p=new WeakMap,w=new WeakMap,M=new WeakMap,k=new WeakMap,B=new WeakMap,L=new WeakMap,f=new WeakMap,u=new WeakMap,h=new WeakMap,l=new WeakMap,E=new WeakMap,b=new WeakMap;function H(o,e,t){o.classList.contains(e)||o.classList.add(e),o.classList.remove(t)}function Q(o,e){return Promise.resolve(setTimeout(o,e))}function O(o){console.log(o.id,o.classList);const{classList:e}=o;e.forEach(t=>{V.includes(t)&&(console.log(`remove ${t} from ${e}`),e.remove(t))})}const c=new j,W=window.localStorage,m=new Y(W),X=c.gameToggleBtn,Z=c.ruleModalToggleBtn,D=c.gameHandSelectors,ee=c.newGameBtn;window.addEventListener("load",()=>{c.paintHeader(m.type,m.score)});X.addEventListener("click",()=>{m.toggleGameType(),c.toggleGameMode(m.type),c.paintHeader(m.type,m.score)});D.forEach(o=>{o.addEventListener("click",()=>{const e=c.getHandInfo(o),t=m.play(e);c.showResultUI(t)})});Z.addEventListener("click",()=>c.toggleRulesModal(m.type));ee.addEventListener("click",()=>{c.showGameBoardUI()});
